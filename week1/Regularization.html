
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>L1 and L2 Regularization &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'week1/Regularization';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="What is Decision Tree?" href="../week2/1.DecisionTree.html" />
    <link rel="prev" title="Logistic Regression" href="Logistic_Regression.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <img src="../_static/logo.png" class="logo__image only-dark pst-js-only" alt="My sample book - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.NaiveBayes.html">What is Naive Bayes Classifier?</a></li>

<li class="toctree-l1"><a class="reference internal" href="2.KNN.html">K-Nearest Neighbor(KNN) Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="Linear_Regression.html"><strong>Linear Regression</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Logistic_Regression.html">Logistic Regression</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">L1 and L2 Regularization</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week2/1.DecisionTree.html">What is Decision Tree?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week2/2.PCA.html">What is Principal Component Analysis?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week2/3.Hierarchical%20Clustering.html">What is Hierarchical Clustering?</a></li>

<li class="toctree-l1"><a class="reference internal" href="../week2/Gradient%20Boosting.html"><strong>Gradient Boosting Overview</strong></a></li>

<li class="toctree-l1"><a class="reference internal" href="../week2/Kmeans.html">K-means Clustering</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week3/1.svm.html">What is Support Vector Machine Algorithm?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week3/CatBoost.html">CatBoost: Concept and Mathematical Implementation</a></li>

<li class="toctree-l1"><a class="reference internal" href="../week3/Random_Forest.html">Random forest</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week4/1.collaborative_filtering.html">What is Collaborative Filtering?</a></li>


<li class="toctree-l1"><a class="reference internal" href="../week4/Market_Basket_Analysis.html">Market Basket Analysis (MBA)</a></li>


<li class="toctree-l1"><a class="reference internal" href="../week4/NDCG.html"><strong>Understanding NDCG (Normalized Discounted Cumulative Gain)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../week4/Semantic%20Search.html">1. Introduction to Semantic Search</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 5</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week5/3.%20finetune_practice.html">1. What are the Training types of each encoder and decoder models?</a></li>



<li class="toctree-l1"><a class="reference internal" href="../week5/TF-IDF%2C%20BoW%2C%20Faiss.html">TF-IDF</a></li>


<li class="toctree-l1"><a class="reference internal" href="../week5/Transformer%2C_LoRA.html">Set Up Hugging Face Space Environment</a></li>



</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fweek1/Regularization.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/week1/Regularization.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>L1 and L2 Regularization</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-obejective">Learning Obejective</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">1. Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-l1-and-l2-regularization">2. What is L1 and L2 Regularization?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loss-function-and-gradient-descent">3. Loss Function and Gradient Descent</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#weight-update-rule-with-ols-regression">Weight Update Rule with OLS Regression</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gradient-of-l1-regularization">Gradient of L1 Regularization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gradient-of-l2-regularization">Gradient of L2 Regularization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#weight-update-rule-with-l2-regularization">Weight Update Rule with L2 Regularization</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geometric-interpretation">4. Geometric interpretation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ridge-regression-constraint">Ridge Regression Constraint</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lasso-regression-constraint">Lasso Regression Constraint</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-differences-between-ridge-vs-lasso-and-typical-uses-cases">5. Key differences between ridge vs lasso and Typical Uses cases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementing-ridge-lass-regression">6. Implementing Ridge/Lass regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summarize-key-takeaways">7. Summarize Key Takeaways</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-reading-resources">8. Additional Reading Resources:</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="l1-and-l2-regularization">
<h1>L1 and L2 Regularization<a class="headerlink" href="#l1-and-l2-regularization" title="Link to this heading">#</a></h1>
<section id="learning-obejective">
<h2>Learning Obejective<a class="headerlink" href="#learning-obejective" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Delve into the issue of overfitting in statistical models and discover how regularization techniques can address it.</p></li>
<li><p>Understand the fundamentals of regularization, with a focus on Ridge/Lasso regression.</p></li>
<li><p>Learn 3 different loss function to demonstrate the effect of L1 and L2 regularization.</p></li>
<li><p>Investigate the trade-offs in selecting the appropriate regularization parameter (lambda) in Ridge/lasso regression by using Python code.</p></li>
</ul>
</section>
<section id="introduction">
<h2>1. Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>We will discuss their concepts and application, underline their differences, and provide practical examples of implementing these techniques in Python. <br/>
An essential idea in regression is to fit a line through a series of data points, but this approach can lead to overfitting, especially when the model has too many parameters or attempts to capture the noise within the training data. This results in a model that is overly tailored to the specific dataset and struggles to generalize to new data.</p>
<p>L1 and L2 regularization are techniques within regression that work by constraining or reducing the magnitude of the coefficient estimates, pulling them closer to zero. Essentially, these methods help prevent the model from becoming overly complex or too flexible, thereby reducing the likelihood of overfitting.</p>
</section>
<section id="what-is-l1-and-l2-regularization">
<h2>2. What is L1 and L2 Regularization?<a class="headerlink" href="#what-is-l1-and-l2-regularization" title="Link to this heading">#</a></h2>
<p>The formula for the Residual Sum of Squares (RSS) is:</p>
<div class="math notranslate nohighlight">
\[
RSS = \sum_{i=1}^{n} \left( y_i - \hat{y}_i \right)^2
\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(y_i\)</span> is the actual value,</p></li>
<li><p><span class="math notranslate nohighlight">\(\hat{y}_i\)</span> is the predicted value,</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> is the number of observations.</p></li>
</ul>
<p>This formula measures model prediction accuracy for ground-truth values in the training data. If RSS = 0, the model perfectly predicts dependent variables. A score of zero is not always desirable, however, as it can indicate overfitting on the training data, particularly if the training dataset is small. Multicollinearity may be one cause of this.</p>
<p>High coefficient estimates can often be symptomatic of overfitting. If two or more variables share a high, linear correlation, OLS may return erroneously high-value coefficients. When one or more coefficients are too high, the model’s output becomes sensitive to minor alterations in the input data. In other words, the model has overfitted on a specific training set and fails to accurately generalize on new test sets. Such a model is considered unstable. This is where the regularization technique comes in handy.</p>
<p><strong>Ordinary Least Squares Loss:</strong></p>
<div class="math notranslate nohighlight">
\[
\text{Ordinary Least Squares Loss: } = \frac{1}{2n} \sum_{i=1}^{n} (y_i - \hat{y}_i)^2
\]</div>
<p><strong>L1 Regularization Loss:</strong></p>
<div class="math notranslate nohighlight">
\[
\text{L1 Regularization Loss: } = \text{Loss}_{\text{OLS}} + \lambda \sum_{i=1}^{n} |w_i|
\]</div>
<p><strong>L2 Regularization Loss:</strong></p>
<div class="math notranslate nohighlight">
\[
\text{L2 Regularization Loss: } = \text{Loss}_{\text{OLS}} + \frac{\lambda}{2} \sum_{i=1}^{n} w_i^2
\]</div>
<p>Lasso Regression : Performs L1 regularization, i.e., adds penalty equivalent to the <strong>absolute value of the magnitude of coefficients</strong> <br/>
Ridge Regression : Performs L2 regularization, i.e., adds penalty equivalent to the <strong>square of the magnitude of coefficients</strong></p>
</section>
<section id="loss-function-and-gradient-descent">
<h2>3. Loss Function and Gradient Descent<a class="headerlink" href="#loss-function-and-gradient-descent" title="Link to this heading">#</a></h2>
<p>some intuitions why L1 and L2 work by explaining using gradient descent. Gradient descent is simply a method to find the ‘right’ coefficients through iterative updates using the value of the gradient.</p>
<section id="weight-update-rule-with-ols-regression">
<h3>Weight Update Rule with OLS Regression<a class="headerlink" href="#weight-update-rule-with-ols-regression" title="Link to this heading">#</a></h3>
<p>Predicted value:</p>
<div class="math notranslate nohighlight">
\[\hat{y} = wx+b \]</div>
<p>The OLS loss function is:</p>
<div class="math notranslate nohighlight">
\[
\text{Loss}_{\text{OLS}} = \frac{1}{2n} \sum_{i=1}^{n} (y_i - \hat{y}_i)^2
\]</div>
<p>The weight update rule for OLS regression is:</p>
<div class="math notranslate nohighlight">
\[
\mathbf{w} \leftarrow \mathbf{w} - \eta \cdot \frac{\partial \text{Loss}_{\text{OLS}}}{\partial \mathbf{w}}
\]</div>
</section>
<section id="gradient-of-l1-regularization">
<h3>Gradient of L1 Regularization<a class="headerlink" href="#gradient-of-l1-regularization" title="Link to this heading">#</a></h3>
<p>The L1 regularization term is:</p>
<div class="math notranslate nohighlight">
\[
\lambda \sum_{i=1}^{n} |w_i|
\]</div>
<p>The subgradient with respect to each coefficient ( w_i ) is:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial}{\partial w_i} \lambda |w_i| = \lambda \cdot \text{sign}(w_i)
\]</div>
<p>Where:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\text{sign}(w_i) = \begin{cases} 
      -1 &amp; \text{if } w_i &lt; 0 \\
      0 &amp; \text{if } w_i = 0 \\
      1 &amp; \text{if } w_i &gt; 0 
   \end{cases}
\end{split}\]</div>
<p>The gradient (subgradient) with respect to each coefficient ( w_i ) is:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \text{Loss}_{\text{Lasso}}}{\partial w_i} = \frac{\partial \text{Loss}_{\text{OLS}}}{\partial w_i} + \lambda \cdot \text{sign}(w_i)
\]</div>
<p>The weight update rule with L1 regularization is:</p>
<div class="math notranslate nohighlight">
\[
w_i \leftarrow w_i - \eta \left( \frac{\partial \text{Loss}_{\text{OLS}}}{\partial w_i} + \lambda \cdot \text{sign}(w_i) \right)
\]</div>
<p>This means that:</p>
<ul class="simple">
<li><p>If \( w_j &gt; 0 \), it gets decreased by \( \lambda \) at each step.</p></li>
<li><p>If \( w_j &lt; 0 \), it gets increased by \( \lambda \) at each step.</p></li>
<li><p>If \( w_j = 0 \), it stays at 0.</p></li>
</ul>
<p><img alt="Screenshot 2024-08-25 115404.png" src="week1/attachment:7b8369d5-2bd4-49c3-a866-6e03755659ac.png" /></p>
</section>
<section id="gradient-of-l2-regularization">
<h3>Gradient of L2 Regularization<a class="headerlink" href="#gradient-of-l2-regularization" title="Link to this heading">#</a></h3>
<p>The L2 regularization term is:</p>
<div class="math notranslate nohighlight">
\[
\frac{\lambda}{2} \sum_{i=1}^{n} w_i^2
\]</div>
<p>The gradient with respect to each coefficient ( w_i ) is:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \text{Loss}}{\partial w_i} = \lambda w_i
\]</div>
</section>
<section id="weight-update-rule-with-l2-regularization">
<h3>Weight Update Rule with L2 Regularization<a class="headerlink" href="#weight-update-rule-with-l2-regularization" title="Link to this heading">#</a></h3>
<p>The weight update rule in gradient descent with L2 regularization is:</p>
<div class="math notranslate nohighlight">
\[
w_i \leftarrow w_i - \eta \left( \frac{\partial \text{Loss}_{\text{OLS}}}{\partial w_i} + \lambda w_i \right)
\]</div>
<p>Here, <span class="math notranslate nohighlight">\( \eta \)</span> is the learning rate. The term <span class="math notranslate nohighlight">\( \lambda w_i \)</span> shrinks the coefficient <span class="math notranslate nohighlight">\( w_i \)</span> by a factor proportional to its value. The larger the coefficient, the stronger the shrinkage, but the gradient never reaches zero unless <span class="math notranslate nohighlight">\( w_i \)</span> is exactly zero to start with. Therefore, L2 regularization tends to reduce the coefficients towards zero but not exactly zero.</p>
<p><strong>Why L1 Regularization Can Set Coefficients Exactly to Zero:</strong></p>
<p>Because L1 regularization adds a constant amount (<span class="math notranslate nohighlight">\(\lambda\)</span>) to the gradient (depending on the sign of <span class="math notranslate nohighlight">\(w_i\)</span>), it can eventually shrink small coefficients completely to zero. If the gradient from the RSS is smaller than <span class="math notranslate nohighlight">\(\lambda\)</span>, the update will push <span class="math notranslate nohighlight">\(w_i\)</span> to zero. Once <span class="math notranslate nohighlight">\(w_i\)</span> becomes zero, it tends to stay zero because the gradient from the penalty term at zero is constant. <br/></p>
<p><strong>Why L2 Regulairzation Doesn’t Set Coefficients to Exactly Zero:</strong></p>
<p>In contrast, L2 regularization shrinks coefficients proportionally to their size (due to the <span class="math notranslate nohighlight">\(\lambda w_i\)</span> term). This proportional shrinkage gets smaller as <span class="math notranslate nohighlight">\(w_i\)</span> approaches zero, but it never actually forces <span class="math notranslate nohighlight">\(w_i\)</span> to become zero unless the gradient from the RSS term drives it there. The shrinkage slows down as <span class="math notranslate nohighlight">\(w_i\)</span> gets smaller, leading to coefficients that are small but not exactly zero.</p>
</section>
</section>
<section id="geometric-interpretation">
<h2>4. Geometric interpretation<a class="headerlink" href="#geometric-interpretation" title="Link to this heading">#</a></h2>
<p>Contours: the mean squared error loss function (the squared distance between the true and predicted values) for two weight coefficient <span class="math notranslate nohighlight">\(\beta\)</span>1 and <span class="math notranslate nohighlight">\(\beta\)</span>2 <br/>
<strong>Goal:</strong> find the combinations of  <span class="math notranslate nohighlight">\(\beta\)</span>1 and <span class="math notranslate nohighlight">\(\beta\)</span>2 that minimize the loss function and <strong><span class="math notranslate nohighlight">\(\hat{\beta}\)</span></strong> is Minimze loss point</p>
<p><img alt="Screenshot 2024-08-24 105049.png" src="week1/attachment:23bf1b6e-a514-4905-971d-970579caa010.png" /></p>
<p><img alt="Screenshot 2024-08-24 104904.png" src="week1/attachment:f6481d96-ad94-4990-869d-4620768e1c72.png" /></p>
<section id="ridge-regression-constraint">
<h3>Ridge Regression Constraint<a class="headerlink" href="#ridge-regression-constraint" title="Link to this heading">#</a></h3>
<p>The constraint for Ridge regression is:</p>
<div class="math notranslate nohighlight">
\[
\beta_1^2 + \beta_2^2 \leq s
\]</div>
</section>
<section id="lasso-regression-constraint">
<h3>Lasso Regression Constraint<a class="headerlink" href="#lasso-regression-constraint" title="Link to this heading">#</a></h3>
<p>The constraint for Lasso regression is:</p>
<div class="math notranslate nohighlight">
\[
|\beta_1| + |\beta_2| \leq s
\]</div>
<p><img alt="Screenshot 2024-08-24 104943.png" src="week1/attachment:8906b8b9-d7f9-45bd-9e03-e28f54d644de.png" /></p>
</section>
</section>
<section id="key-differences-between-ridge-vs-lasso-and-typical-uses-cases">
<h2>5. Key differences between ridge vs lasso and Typical Uses cases<a class="headerlink" href="#key-differences-between-ridge-vs-lasso-and-typical-uses-cases" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>characteristic</p></th>
<th class="head"><p>Ridge Regression</p></th>
<th class="head"><p>Lasso Rregression</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Penalty Type</p></td>
<td><p>Ridge regression applies an L2 penalty, which involves adding the squared values of the coefficients, scaled by a tuning parameter (lambda)</p></td>
<td><p>Lasso regression uses an L1 penalty, which sums the absolute values of the coefficients, scaled by lambda</p></td>
</tr>
<tr class="row-odd"><td><p>Coefficient Impact</p></td>
<td><p>The L2 penalty in ridge regression discourages excessively large coefficients by shrinking them towards zero, although they never reach exactly zero. This reduces the influence of less significant features.</p></td>
<td><p>The L1 penalty in lasso regression can shrink some coefficients to exactly zero when lambda is sufficiently large, performing feature selection and creating a model with fewer variables.</p></td>
</tr>
<tr class="row-even"><td><p>Feature Selection</p></td>
<td><p>Ridge regression includes all features in the model but reduces the influence of less significant ones by shrinking their coefficients</p></td>
<td><p>Lasso regression can eliminate some coefficients entirely, leading to a model that includes only the most relevant features, enhancing model interpretability.</p></td>
</tr>
<tr class="row-odd"><td><p>Use Case</p></td>
<td><p>Ridge regression is useful when the goal is to minimize the impact of less important features while keeping all variables in the model. It’s useful when you suspect that many features contribute to the outcome, even if weakly</p></td>
<td><p>Lasso regression is preferable for feature selection, producing a simpler and more interpretable model with a reduced number of variables</p></td>
</tr>
<tr class="row-even"><td><p>Sparsity</p></td>
<td><p>Ridge regression does not yield sparse models since all coefficients remain non-zero</p></td>
<td><p>Lasso regression can produce sparse models by setting some coefficients to exactly zero</p></td>
</tr>
<tr class="row-odd"><td><p>Sensitivity</p></td>
<td><p>Generally more robust and less influenced by outliers compared to lasso regression</p></td>
<td><p>More sensitive to outliers due to the absolute value in the penalty term</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="implementing-ridge-lass-regression">
<h2>6. Implementing Ridge/Lass regression<a class="headerlink" href="#implementing-ridge-lass-regression" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.pylab</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">10</span>

<span class="c1"># Create x values</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">4</span><span class="p">)])</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># Setting seed for reproducibility</span>

<span class="c1"># Use cosine function instead of sine</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="c1"># Create a dataframe</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>

<span class="c1"># Plot the data</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">random</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">from</span> <span class="nn">matplotlib.pylab</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">10</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;matplotlib&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">16</span><span class="p">):</span>  
    <span class="n">colname</span> <span class="o">=</span> <span class="s1">&#39;x_</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">i</span>      
    <span class="n">data</span><span class="p">[</span><span class="n">colname</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">**</span><span class="n">i</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          x         y       x_2       x_3       x_4       x_5       x_6  \
0  1.047198  0.699738  1.096623  1.148381  1.202581  1.259340  1.318778   
1  1.117011  0.545663  1.247713  1.393709  1.556788  1.738948  1.942424   
2  1.186824  0.142797  1.408551  1.671702  1.984016  2.354677  2.794587   
3  1.256637  0.307759  1.579137  1.984402  2.493673  3.133642  3.937850   
4  1.326450  0.335122  1.759470  2.333850  3.095735  4.106339  5.446854   

        x_7       x_8        x_9       x_10       x_11       x_12       x_13  \
0  1.381021  1.446202   1.514459   1.585938   1.660790   1.739176   1.821260   
1  2.169709  2.423588   2.707173   3.023942   3.377775   3.773011   4.214494   
2  3.316683  3.936319   4.671717   5.544505   6.580351   7.809718   9.268760   
3  4.948448  6.218404   7.814277   9.819710  12.339811  15.506664  19.486248   
4  7.224981  9.583578  12.712139  16.862020  22.366630  29.668222  39.353420   

        x_14       x_15  
0   1.907219   1.997235  
1   4.707635   5.258479  
2  11.000386  13.055521  
3  24.487142  30.771450  
4  52.200353  69.241170  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">make_pipeline</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">linear_regression</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="n">models_to_plot</span><span class="p">):</span>
    <span class="n">predictors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">power</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">predictors</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;x_</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">power</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>

    <span class="n">linreg</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">LinearRegression</span><span class="p">())</span>
    <span class="n">linreg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">predictors</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">linreg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">predictors</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">power</span> <span class="ow">in</span> <span class="n">models_to_plot</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">models_to_plot</span><span class="p">[</span><span class="n">power</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Plot for power: </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">power</span><span class="p">)</span>

    <span class="n">rss</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">y_pred</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="n">linreg</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s1">&#39;linearregression&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">intercept_</span>
    <span class="n">coef</span> <span class="o">=</span> <span class="n">linreg</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s1">&#39;linearregression&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">coef_</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="p">[</span><span class="n">rss</span><span class="p">,</span> <span class="n">intercept</span><span class="p">]</span>
    <span class="n">ret</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">coef</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rss&#39;</span><span class="p">,</span> <span class="s1">&#39;intercept&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;coef_x_</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)]</span>
<span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;model_pow_</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)]</span>
<span class="n">coef_matrix_simple</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>

<span class="n">models_to_plot</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">234</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">235</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span> <span class="mi">236</span><span class="p">}</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">linear_regression</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">power</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">models_to_plot</span><span class="o">=</span><span class="n">models_to_plot</span><span class="p">)</span>
    <span class="n">coef_matrix_simple</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)]</span> <span class="o">=</span> <span class="n">result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d3f60a998b313bbf8c27f52ebf046a419ab9cda7bcaa419cf5e733f4aa9b71db.png" src="../_images/d3f60a998b313bbf8c27f52ebf046a419ab9cda7bcaa419cf5e733f4aa9b71db.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">float_format</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:,.2g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span>
<span class="n">coef_matrix_simple</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rss</th>
      <th>intercept</th>
      <th>coef_x_1</th>
      <th>coef_x_2</th>
      <th>coef_x_3</th>
      <th>coef_x_4</th>
      <th>coef_x_5</th>
      <th>coef_x_6</th>
      <th>coef_x_7</th>
      <th>coef_x_8</th>
      <th>coef_x_9</th>
      <th>coef_x_10</th>
      <th>coef_x_11</th>
      <th>coef_x_12</th>
      <th>coef_x_13</th>
      <th>coef_x_14</th>
      <th>coef_x_15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>model_pow_1</th>
      <td>15</td>
      <td>-0.39</td>
      <td>-0.02</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>model_pow_2</th>
      <td>1.1</td>
      <td>-0.39</td>
      <td>-2.8</td>
      <td>2.8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>model_pow_3</th>
      <td>1.1</td>
      <td>-0.39</td>
      <td>-2.4</td>
      <td>2</td>
      <td>0.48</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>model_pow_4</th>
      <td>1</td>
      <td>-0.39</td>
      <td>0.085</td>
      <td>-6.8</td>
      <td>11</td>
      <td>-4.3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>model_pow_5</th>
      <td>1</td>
      <td>-0.39</td>
      <td>-5.4</td>
      <td>20</td>
      <td>-40</td>
      <td>39</td>
      <td>-14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>model_pow_6</th>
      <td>0.99</td>
      <td>-0.39</td>
      <td>11</td>
      <td>-80</td>
      <td>2.2e+02</td>
      <td>-3.1e+02</td>
      <td>2.2e+02</td>
      <td>-62</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>model_pow_7</th>
      <td>0.93</td>
      <td>-0.39</td>
      <td>-69</td>
      <td>5.3e+02</td>
      <td>-1.8e+03</td>
      <td>3.4e+03</td>
      <td>-3.6e+03</td>
      <td>2e+03</td>
      <td>-4.8e+02</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>model_pow_8</th>
      <td>0.92</td>
      <td>-0.39</td>
      <td>-1.7e+02</td>
      <td>1.4e+03</td>
      <td>-5.3e+03</td>
      <td>1.2e+04</td>
      <td>-1.5e+04</td>
      <td>1.2e+04</td>
      <td>-5.2e+03</td>
      <td>9.5e+02</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>model_pow_9</th>
      <td>0.87</td>
      <td>-0.39</td>
      <td>-7.4e+02</td>
      <td>7.3e+03</td>
      <td>-3.4e+04</td>
      <td>9.3e+04</td>
      <td>-1.6e+05</td>
      <td>1.8e+05</td>
      <td>-1.3e+05</td>
      <td>5.2e+04</td>
      <td>-9.2e+03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>model_pow_10</th>
      <td>0.87</td>
      <td>-0.39</td>
      <td>-5.9e+02</td>
      <td>5.5e+03</td>
      <td>-2.4e+04</td>
      <td>5.9e+04</td>
      <td>-8.8e+04</td>
      <td>7.3e+04</td>
      <td>-2e+04</td>
      <td>-1.7e+04</td>
      <td>1.6e+04</td>
      <td>-4.1e+03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>model_pow_11</th>
      <td>0.87</td>
      <td>-0.39</td>
      <td>6.2e+02</td>
      <td>-1e+04</td>
      <td>7.5e+04</td>
      <td>-3.3e+05</td>
      <td>9.2e+05</td>
      <td>-1.8e+06</td>
      <td>2.3e+06</td>
      <td>-2e+06</td>
      <td>1.1e+06</td>
      <td>-3.7e+05</td>
      <td>5.4e+04</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>model_pow_12</th>
      <td>0.87</td>
      <td>-0.39</td>
      <td>2.3e+03</td>
      <td>-3.4e+04</td>
      <td>2.4e+05</td>
      <td>-1.1e+06</td>
      <td>3.1e+06</td>
      <td>-6.5e+06</td>
      <td>9.6e+06</td>
      <td>-1e+07</td>
      <td>7.2e+06</td>
      <td>-3.4e+06</td>
      <td>9.7e+05</td>
      <td>-1.2e+05</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>model_pow_13</th>
      <td>0.86</td>
      <td>-0.39</td>
      <td>-2.2e+04</td>
      <td>3.4e+05</td>
      <td>-2.7e+06</td>
      <td>1.3e+07</td>
      <td>-4.6e+07</td>
      <td>1.2e+08</td>
      <td>-2.1e+08</td>
      <td>2.9e+08</td>
      <td>-2.8e+08</td>
      <td>1.9e+08</td>
      <td>-8.9e+07</td>
      <td>2.5e+07</td>
      <td>-3.1e+06</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>model_pow_14</th>
      <td>0.79</td>
      <td>-0.39</td>
      <td>-1.7e+05</td>
      <td>2.9e+06</td>
      <td>-2.4e+07</td>
      <td>1.3e+08</td>
      <td>-5.1e+08</td>
      <td>1.4e+09</td>
      <td>-2.9e+09</td>
      <td>4.6e+09</td>
      <td>-5.3e+09</td>
      <td>4.5e+09</td>
      <td>-2.8e+09</td>
      <td>1.2e+09</td>
      <td>-2.9e+08</td>
      <td>3.3e+07</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>model_pow_15</th>
      <td>0.7</td>
      <td>-0.39</td>
      <td>2.9e+05</td>
      <td>-5.7e+06</td>
      <td>5.5e+07</td>
      <td>-3.5e+08</td>
      <td>1.5e+09</td>
      <td>-5e+09</td>
      <td>1.2e+10</td>
      <td>-2.3e+10</td>
      <td>3.3e+10</td>
      <td>-3.6e+10</td>
      <td>2.9e+10</td>
      <td>-1.7e+10</td>
      <td>6.7e+09</td>
      <td>-1.6e+09</td>
      <td>1.8e+08</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This clearly aligns with our initial understanding. As the model complexity increases, the models tend to fit even smaller deviations in the training data set. <br/>
It is clearly evident that the size of coefficients increases exponentially with an increase in model complexity. I hope this gives some intuition into why putting a constraint on the magnitude of coefficients can be a good idea to reduce model complexity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span>

<span class="k">def</span> <span class="nf">ridge_regression</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">predictors</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">models_to_plot</span><span class="o">=</span><span class="p">{}):</span>
    <span class="n">ridgereg</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">))</span>
    <span class="n">ridgereg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">predictors</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">ridgereg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">predictors</span><span class="p">])</span>
    
    <span class="k">if</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">models_to_plot</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">models_to_plot</span><span class="p">[</span><span class="n">alpha</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Plot for alpha: </span><span class="si">%.3g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">alpha</span><span class="p">)</span>
    
    <span class="n">rss</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">y_pred</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="n">ridgereg</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">intercept_</span>
    <span class="n">coef</span> <span class="o">=</span> <span class="n">ridgereg</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s1">&#39;ridge&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">coef_</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="p">[</span><span class="n">rss</span><span class="p">,</span> <span class="n">intercept</span><span class="p">]</span>
    <span class="n">ret</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">coef</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="n">predictors</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;x_</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">)])</span>

<span class="c1"># Set the different values of alpha to be tested</span>
<span class="n">alpha_ridge</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-15</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>

<span class="c1"># Initialize the dataframe for storing coefficients</span>
<span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rss&#39;</span><span class="p">,</span> <span class="s1">&#39;intercept&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;coef_x_</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)]</span>
<span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;alpha_</span><span class="si">%.2g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">alpha_ridge</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">coef_matrix_ridge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>

<span class="c1"># Define which models to plot</span>
<span class="n">models_to_plot</span> <span class="o">=</span> <span class="p">{</span><span class="mf">1e-15</span><span class="p">:</span> <span class="mi">231</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">:</span> <span class="mi">232</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">:</span> <span class="mi">233</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">:</span> <span class="mi">234</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">:</span> <span class="mi">235</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">236</span><span class="p">}</span>

<span class="c1"># Iterate through the alpha values and store results</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">coef_matrix_ridge</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">ridge_regression</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">predictors</span><span class="p">,</span> <span class="n">alpha_ridge</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">models_to_plot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/36aae278211bb5709904665e8e0bbd9d4a44e587049f09a8d963815158b3d010.png" src="../_images/36aae278211bb5709904665e8e0bbd9d4a44e587049f09a8d963815158b3d010.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">float_format</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:,.2g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span>
<span class="n">coef_matrix_ridge</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rss</th>
      <th>intercept</th>
      <th>coef_x_1</th>
      <th>coef_x_2</th>
      <th>coef_x_3</th>
      <th>coef_x_4</th>
      <th>coef_x_5</th>
      <th>coef_x_6</th>
      <th>coef_x_7</th>
      <th>coef_x_8</th>
      <th>coef_x_9</th>
      <th>coef_x_10</th>
      <th>coef_x_11</th>
      <th>coef_x_12</th>
      <th>coef_x_13</th>
      <th>coef_x_14</th>
      <th>coef_x_15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alpha_1e-15</th>
      <td>0.87</td>
      <td>0.038</td>
      <td>4.8e+02</td>
      <td>-7.3e+03</td>
      <td>4.8e+04</td>
      <td>-1.8e+05</td>
      <td>3.8e+05</td>
      <td>-4e+05</td>
      <td>3.2e+04</td>
      <td>3.9e+05</td>
      <td>-2.1e+05</td>
      <td>-3.2e+05</td>
      <td>3.1e+05</td>
      <td>2.3e+05</td>
      <td>-4.8e+05</td>
      <td>2.7e+05</td>
      <td>-5.3e+04</td>
    </tr>
    <tr>
      <th>alpha_1e-10</th>
      <td>0.89</td>
      <td>0.038</td>
      <td>-1.5e+02</td>
      <td>1.1e+03</td>
      <td>-3.4e+03</td>
      <td>4.5e+03</td>
      <td>-1e+03</td>
      <td>-3.1e+03</td>
      <td>6.2e+02</td>
      <td>2.6e+03</td>
      <td>5.6e+02</td>
      <td>-1.8e+03</td>
      <td>-1.4e+03</td>
      <td>8.2e+02</td>
      <td>1.4e+03</td>
      <td>-8.4e+02</td>
      <td>27</td>
    </tr>
    <tr>
      <th>alpha_1e-08</th>
      <td>0.93</td>
      <td>0.038</td>
      <td>-26</td>
      <td>1.7e+02</td>
      <td>-4.3e+02</td>
      <td>4e+02</td>
      <td>1.3e+02</td>
      <td>-3e+02</td>
      <td>-2e+02</td>
      <td>1.5e+02</td>
      <td>2.7e+02</td>
      <td>62</td>
      <td>-2e+02</td>
      <td>-2.2e+02</td>
      <td>50</td>
      <td>3e+02</td>
      <td>-1.6e+02</td>
    </tr>
    <tr>
      <th>alpha_0.0001</th>
      <td>0.95</td>
      <td>0.038</td>
      <td>1.2</td>
      <td>-2.2</td>
      <td>-1.5</td>
      <td>0.47</td>
      <td>1.1</td>
      <td>0.52</td>
      <td>-0.35</td>
      <td>-0.79</td>
      <td>-0.59</td>
      <td>0.07</td>
      <td>0.87</td>
      <td>1.4</td>
      <td>1.3</td>
      <td>0.12</td>
      <td>-2.3</td>
    </tr>
    <tr>
      <th>alpha_0.001</th>
      <td>0.96</td>
      <td>0.038</td>
      <td>0.9</td>
      <td>-1.5</td>
      <td>-1.1</td>
      <td>-0.24</td>
      <td>0.19</td>
      <td>0.25</td>
      <td>0.18</td>
      <td>0.16</td>
      <td>0.23</td>
      <td>0.35</td>
      <td>0.44</td>
      <td>0.42</td>
      <td>0.21</td>
      <td>-0.23</td>
      <td>-0.97</td>
    </tr>
    <tr>
      <th>alpha_0.01</th>
      <td>0.96</td>
      <td>0.038</td>
      <td>0.6</td>
      <td>-0.89</td>
      <td>-1</td>
      <td>-0.6</td>
      <td>-0.16</td>
      <td>0.18</td>
      <td>0.38</td>
      <td>0.47</td>
      <td>0.48</td>
      <td>0.42</td>
      <td>0.3</td>
      <td>0.14</td>
      <td>-0.07</td>
      <td>-0.32</td>
      <td>-0.61</td>
    </tr>
    <tr>
      <th>alpha_1</th>
      <td>1.6</td>
      <td>0.038</td>
      <td>-0.18</td>
      <td>-0.35</td>
      <td>-0.33</td>
      <td>-0.23</td>
      <td>-0.11</td>
      <td>-0.011</td>
      <td>0.066</td>
      <td>0.11</td>
      <td>0.13</td>
      <td>0.13</td>
      <td>0.11</td>
      <td>0.076</td>
      <td>0.031</td>
      <td>-0.021</td>
      <td>-0.08</td>
    </tr>
    <tr>
      <th>alpha_5</th>
      <td>1.9</td>
      <td>0.038</td>
      <td>-0.27</td>
      <td>-0.26</td>
      <td>-0.21</td>
      <td>-0.15</td>
      <td>-0.092</td>
      <td>-0.042</td>
      <td>-0.0024</td>
      <td>0.026</td>
      <td>0.044</td>
      <td>0.055</td>
      <td>0.06</td>
      <td>0.06</td>
      <td>0.055</td>
      <td>0.048</td>
      <td>0.039</td>
    </tr>
    <tr>
      <th>alpha_10</th>
      <td>2.2</td>
      <td>0.038</td>
      <td>-0.26</td>
      <td>-0.24</td>
      <td>-0.19</td>
      <td>-0.14</td>
      <td>-0.09</td>
      <td>-0.049</td>
      <td>-0.017</td>
      <td>0.0079</td>
      <td>0.026</td>
      <td>0.039</td>
      <td>0.048</td>
      <td>0.053</td>
      <td>0.056</td>
      <td>0.056</td>
      <td>0.055</td>
    </tr>
    <tr>
      <th>alpha_20</th>
      <td>2.8</td>
      <td>0.038</td>
      <td>-0.24</td>
      <td>-0.21</td>
      <td>-0.17</td>
      <td>-0.12</td>
      <td>-0.085</td>
      <td>-0.053</td>
      <td>-0.026</td>
      <td>-0.0045</td>
      <td>0.012</td>
      <td>0.026</td>
      <td>0.036</td>
      <td>0.043</td>
      <td>0.049</td>
      <td>0.053</td>
      <td>0.055</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coef_matrix_ridge</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="o">==</span><span class="mi">0</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>alpha_1e-15     0
alpha_1e-10     0
alpha_1e-08     0
alpha_0.0001    0
alpha_0.001     0
alpha_0.01      0
alpha_1         0
alpha_5         0
alpha_10        0
alpha_20        0
dtype: int32
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Lasso</span>

<span class="k">def</span> <span class="nf">lasso_regression</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">predictors</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">models_to_plot</span><span class="o">=</span><span class="p">{}):</span>
    <span class="n">lassoreg</span> <span class="o">=</span> <span class="n">make_pipeline</span><span class="p">(</span><span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">)))</span>
    <span class="n">lassoreg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">predictors</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">lassoreg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">predictors</span><span class="p">])</span>
    
    <span class="k">if</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">models_to_plot</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">models_to_plot</span><span class="p">[</span><span class="n">alpha</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Plot for alpha: </span><span class="si">%.3g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">alpha</span><span class="p">)</span>
    
    <span class="n">rss</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">y_pred</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="n">lassoreg</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s1">&#39;lasso&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">intercept_</span>
    <span class="n">coef</span> <span class="o">=</span> <span class="n">lassoreg</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s1">&#39;lasso&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">coef_</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="p">[</span><span class="n">rss</span><span class="p">,</span> <span class="n">intercept</span><span class="p">]</span>
    <span class="n">ret</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">coef</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="n">predictors</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;x_</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">16</span><span class="p">)])</span>

<span class="n">alpha_lasso</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-15</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>

<span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rss&#39;</span><span class="p">,</span> <span class="s1">&#39;intercept&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;coef_x_</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">)]</span>
<span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;alpha_</span><span class="si">%.2g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">alpha_lasso</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">coef_matrix_lasso</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>

<span class="n">models_to_plot</span> <span class="o">=</span> <span class="p">{</span><span class="mf">1e-10</span><span class="p">:</span> <span class="mi">231</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">:</span> <span class="mi">232</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">:</span> <span class="mi">233</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">:</span> <span class="mi">234</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">:</span> <span class="mi">235</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">236</span><span class="p">}</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">coef_matrix_lasso</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">lasso_regression</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">predictors</span><span class="p">,</span> <span class="n">alpha_lasso</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">models_to_plot</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6ff09c410a410641527005db1bd0dac68119a4f52e367983a2acc85cf2f8c88d.png" src="../_images/6ff09c410a410641527005db1bd0dac68119a4f52e367983a2acc85cf2f8c88d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">float_format</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:,.2g}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span>
<span class="n">coef_matrix_lasso</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rss</th>
      <th>intercept</th>
      <th>coef_x_1</th>
      <th>coef_x_2</th>
      <th>coef_x_3</th>
      <th>coef_x_4</th>
      <th>coef_x_5</th>
      <th>coef_x_6</th>
      <th>coef_x_7</th>
      <th>coef_x_8</th>
      <th>coef_x_9</th>
      <th>coef_x_10</th>
      <th>coef_x_11</th>
      <th>coef_x_12</th>
      <th>coef_x_13</th>
      <th>coef_x_14</th>
      <th>coef_x_15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>alpha_1e-15</th>
      <td>0.96</td>
      <td>-0.39</td>
      <td>-1.5</td>
      <td>-1</td>
      <td>2.7</td>
      <td>1.3</td>
      <td>-0.5</td>
      <td>-1.2</td>
      <td>-0.96</td>
      <td>-0.28</td>
      <td>0.37</td>
      <td>0.78</td>
      <td>0.87</td>
      <td>0.67</td>
      <td>0.23</td>
      <td>-0.38</td>
      <td>-1.1</td>
    </tr>
    <tr>
      <th>alpha_1e-10</th>
      <td>0.96</td>
      <td>-0.39</td>
      <td>-1.5</td>
      <td>-1</td>
      <td>2.7</td>
      <td>1.3</td>
      <td>-0.5</td>
      <td>-1.2</td>
      <td>-0.96</td>
      <td>-0.28</td>
      <td>0.37</td>
      <td>0.78</td>
      <td>0.87</td>
      <td>0.67</td>
      <td>0.23</td>
      <td>-0.38</td>
      <td>-1.1</td>
    </tr>
    <tr>
      <th>alpha_1e-08</th>
      <td>0.96</td>
      <td>-0.39</td>
      <td>-1.5</td>
      <td>-1</td>
      <td>2.7</td>
      <td>1.3</td>
      <td>-0.5</td>
      <td>-1.2</td>
      <td>-0.96</td>
      <td>-0.28</td>
      <td>0.37</td>
      <td>0.78</td>
      <td>0.87</td>
      <td>0.67</td>
      <td>0.23</td>
      <td>-0.38</td>
      <td>-1.1</td>
    </tr>
    <tr>
      <th>alpha_1e-05</th>
      <td>0.96</td>
      <td>-0.39</td>
      <td>-1.7</td>
      <td>-0.048</td>
      <td>2</td>
      <td>0.42</td>
      <td>0</td>
      <td>-0.66</td>
      <td>-0.74</td>
      <td>-0.023</td>
      <td>-0</td>
      <td>0.29</td>
      <td>1</td>
      <td>0.58</td>
      <td>0</td>
      <td>0</td>
      <td>-1.1</td>
    </tr>
    <tr>
      <th>alpha_0.0001</th>
      <td>0.98</td>
      <td>-0.39</td>
      <td>-1.6</td>
      <td>0.071</td>
      <td>1.6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.26</td>
      <td>0.018</td>
      <td>0</td>
      <td>0</td>
      <td>-0</td>
      <td>-0.31</td>
    </tr>
    <tr>
      <th>alpha_0.001</th>
      <td>1</td>
      <td>-0.39</td>
      <td>-1.3</td>
      <td>0</td>
      <td>0.26</td>
      <td>1.3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>-0</td>
      <td>-0</td>
      <td>-0</td>
      <td>-0</td>
      <td>-0</td>
      <td>-0</td>
      <td>-0.2</td>
    </tr>
    <tr>
      <th>alpha_0.01</th>
      <td>1.6</td>
      <td>-0.39</td>
      <td>-0.86</td>
      <td>0</td>
      <td>0</td>
      <td>0.076</td>
      <td>0.97</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>-0</td>
      <td>-0</td>
      <td>-0</td>
      <td>-0</td>
      <td>-0</td>
      <td>-0.11</td>
    </tr>
    <tr>
      <th>alpha_1</th>
      <td>15</td>
      <td>-0.39</td>
      <td>-0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>alpha_5</th>
      <td>15</td>
      <td>-0.39</td>
      <td>-0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>alpha_10</th>
      <td>15</td>
      <td>-0.39</td>
      <td>-0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coef_matrix_lasso</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="o">==</span><span class="mi">0</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>alpha_1e-15      0
alpha_1e-10      0
alpha_1e-08      0
alpha_1e-05      4
alpha_0.0001     9
alpha_0.001     11
alpha_0.01      11
alpha_1         15
alpha_5         15
alpha_10        15
dtype: int32
</pre></div>
</div>
</div>
</div>
<section id="summarize-key-takeaways">
<h3>7. Summarize Key Takeaways<a class="headerlink" href="#summarize-key-takeaways" title="Link to this heading">#</a></h3>
<p><em><strong>Summary:</strong></em> <br/>
L1 Regularization (Lasso): The penalty term is proportional to the absolute value of the coefficients (<span class="math notranslate nohighlight">\(\lambda \sum |w_i|\)</span>). This results in some coefficients being exactly shrunk to zero, which leads to feature selection by excluding less important features from the model. <br/>
L2 Regularization (Ridge): The penalty term is proportional to the square of the coefficients (<span class="math notranslate nohighlight">\(\lambda \sum w_i^2\)</span>). This shrinks coefficients towards zero but doesn’t set any of them exactly to zero, meaning all features are retained with reduced influence. Ridge is more effective when there are many correlated features.</p>
</section>
<section id="additional-reading-resources">
<h3>8. Additional Reading Resources:<a class="headerlink" href="#additional-reading-resources" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://medium.com/&#64;byanalytixlabs/what-are-lasso-and-ridge-techniques-05c7f6630f6b">https://medium.com/&#64;byanalytixlabs/what-are-lasso-and-ridge-techniques-05c7f6630f6b</a></p></li>
<li><p><a class="reference external" href="https://towardsdatascience.com/intuitions-on-l1-and-l2-regularisation-235f2db4c261#1d17">https://towardsdatascience.com/intuitions-on-l1-and-l2-regularisation-235f2db4c261#1d17</a></p></li>
<li><p><a class="reference external" href="https://www.kdnuggets.com/2018/01/regularization-machine-learning.html">https://www.kdnuggets.com/2018/01/regularization-machine-learning.html</a></p></li>
<li><p><a class="reference external" href="https://hastie.su.domains/Papers/ESLII.pdf">https://hastie.su.domains/Papers/ESLII.pdf</a></p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./week1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Logistic_Regression.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Logistic Regression</p>
      </div>
    </a>
    <a class="right-next"
       href="../week2/1.DecisionTree.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">What is Decision Tree?</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-obejective">Learning Obejective</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">1. Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-l1-and-l2-regularization">2. What is L1 and L2 Regularization?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loss-function-and-gradient-descent">3. Loss Function and Gradient Descent</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#weight-update-rule-with-ols-regression">Weight Update Rule with OLS Regression</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gradient-of-l1-regularization">Gradient of L1 Regularization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gradient-of-l2-regularization">Gradient of L2 Regularization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#weight-update-rule-with-l2-regularization">Weight Update Rule with L2 Regularization</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#geometric-interpretation">4. Geometric interpretation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ridge-regression-constraint">Ridge Regression Constraint</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lasso-regression-constraint">Lasso Regression Constraint</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-differences-between-ridge-vs-lasso-and-typical-uses-cases">5. Key differences between ridge vs lasso and Typical Uses cases</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementing-ridge-lass-regression">6. Implementing Ridge/Lass regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#summarize-key-takeaways">7. Summarize Key Takeaways</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-reading-resources">8. Additional Reading Resources:</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>

<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>What is Decision Tree? &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=f0c89327" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=d2032c04" />
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=f0c89327" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/theme.css?v=a243ae73" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'week2/1.DecisionTree';</script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/searchtools.js?v=63a53a7d"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/language_data.js?v=d4673a71"></script>
    <script src="../_static/copybutton_funcs.js?v=776a791e"></script>
    <script src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/scripts/bootstrap.js?v=7583a70d"></script>
    <script src="../_static/scripts/fontawesome.js?v=9b125980"></script>
    <script src="../_static/scripts/pydata-sphinx-theme.js?v=f62441ba"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="What is Principal Component Analysis?" href="2.PCA.html" />
    <link rel="prev" title="L1 and L2 Regularization" href="../week1/Regularization.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <img src="../_static/logo.png" class="logo__image only-dark pst-js-only" alt="My sample book - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Classic Machine Learning Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week1/1.NaiveBayes.html">What is Naive Bayes Classifier?</a></li>

<li class="toctree-l1"><a class="reference internal" href="../week1/2.KNN.html">K-Nearest Neighbor(KNN) Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week1/Linear_Regression.html"><strong>Linear Regression</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../week1/Logistic_Regression.html">Logistic Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week1/Regularization.html">L1 and L2 Regularization</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">What is Decision Tree?</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.PCA.html">What is Principal Component Analysis?</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.Hierarchical%20Clustering.html">What is Hierarchical Clustering?</a></li>

<li class="toctree-l1"><a class="reference internal" href="Gradient%20Boosting.html"><strong>Gradient Boosting Overview</strong></a></li>

<li class="toctree-l1"><a class="reference internal" href="Kmeans.html">K-means Clustering</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week3/1.svm.html">What is Support Vector Machine Algorithm?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week3/CatBoost.html">CatBoost: Concept and Mathematical Implementation</a></li>

<li class="toctree-l1"><a class="reference internal" href="../week3/Random_Forest.html">Random forest</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week4/1.collaborative_filtering.html">What is Collaborative Filtering?</a></li>


<li class="toctree-l1"><a class="reference internal" href="../week4/Market_Basket_Analysis.html">Market Basket Analysis (MBA)</a></li>


<li class="toctree-l1"><a class="reference internal" href="../week4/NDCG.html"><strong>Understanding NDCG (Normalized Discounted Cumulative Gain)</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../week4/Semantic%20Search.html">1. Introduction to Semantic Search</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 5</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week5/3.%20finetune_practice.html">1. What are the Training types of each encoder and decoder models?</a></li>



<li class="toctree-l1"><a class="reference internal" href="../week5/TF-IDF%2C%20BoW%2C%20Faiss.html">TF-IDF</a></li>


<li class="toctree-l1"><a class="reference internal" href="../week5/Transformer%2C_LoRA.html">Set Up Hugging Face Space Environment</a></li>



</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fweek2/1.DecisionTree.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/week2/1.DecisionTree.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>What is Decision Tree?</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dt-structure">1. DT Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#procedure">2. Procedure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metrics-for-splitting">3. Metrics for splitting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advantages-and-disadvantages">4. Advantages and Disadvantages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pruning">5. Pruning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reference-link-https-www-geeksforgeeks-org-decision-tree">Reference Link : https://www.geeksforgeeks.org/decision-tree/</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code-implimentation-from-scratch">6. Code Implimentation from Scratch</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reference-link-https-anderfernandez-com-en-blog-code-decision-tree-python-from-scratch">Reference link : https://anderfernandez.com/en/blog/code-decision-tree-python-from-scratch/</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="what-is-decision-tree">
<h1>What is Decision Tree?<a class="headerlink" href="#what-is-decision-tree" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>Flowchart-like structure</p></li>
</ul>
<section id="dt-structure">
<h2>1. DT Structure<a class="headerlink" href="#dt-structure" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Root Node : Entire dataset - initial decision to be made <br></p></li>
<li><p>Internal Node : decisions on attributes. One or more branches <br></p></li>
<li><p>Branches : outcome of a decision leading to another node. <br></p></li>
<li><p>Leaf Nodes : final decision/prediction. <br></p></li>
</ol>
</section>
<section id="procedure">
<h2>2. Procedure<a class="headerlink" href="#procedure" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Choose a split method such as gini, entropy, or information gain and find the best split on independent variables.</p></li>
<li><p>Subset your data by the threshold you found using the above metrics.</p></li>
<li><p>Iterate this until the last leaf node</p></li>
</ol>
<p><img alt="DecisionTree.png" src="week2/attachment:4fa43aa6-6687-4023-a62c-885602c25ed5.png" /></p>
</section>
<section id="metrics-for-splitting">
<h2>3. Metrics for splitting<a class="headerlink" href="#metrics-for-splitting" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The purpose of the metrics is that we want smaller values on those metrics that make the model with purer result in the target. Example) All yes in one node and all No in another node.</p></li>
<li><p>Gini over entropy is more simpler in terms of calculation and it brings similar result.</p></li>
</ul>
<ol class="arabic simple">
<li><p>Gini impurity : likelihood of incorrect classification</p></li>
</ol>
<ul class="simple">
<li><p>Gini : <span class="math notranslate nohighlight">\( 1- \sum_{i=1}^{n}(p_i)^2 \)</span> where pi is proba of instance being classified into a particular class.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>Entropy : amount of uncertainty or impurity.</p></li>
</ol>
<ul class="simple">
<li><p>Entropy : <span class="math notranslate nohighlight">\( - \sum_{i=1}^{n}p_i\log_2(p_i) \)</span></p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Information Gain : reduction in entropy or Gini inpurity after split</p></li>
</ol>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( Entropy_{parent}-\sum_{i=1}^{n}(\frac{|D_i|}{D}*Entropy(D_i)) \)</span> where Di is subset of D after splitting</p></li>
</ul>
<ol class="arabic simple" start="4">
<li><p>Regression will use MSE, MAPE, MAE etc</p></li>
</ol>
</section>
<section id="advantages-and-disadvantages">
<h2>4. Advantages and Disadvantages<a class="headerlink" href="#advantages-and-disadvantages" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Advantage</p></li>
</ul>
<ol class="arabic simple">
<li><p>Simplicity and Interpretability : Simple and easy to understand</p></li>
<li><p>Versatility : regression and classification</p></li>
<li><p>No required for normalization or scaling for the data</p></li>
<li><p>Non parametric so captures non linear relationship</p></li>
</ol>
<ul class="simple">
<li><p>Disadvantage</p></li>
</ul>
<ol class="arabic simple">
<li><p>Overfitting : if deep enough with many nodes</p></li>
<li><p>Instability : small variations in the data causes different trees</p></li>
<li><p>Bias towards features with more levels: features with more levels can dominate the tree structure.</p></li>
</ol>
</section>
<section id="pruning">
<h2>5. Pruning<a class="headerlink" href="#pruning" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>To avoid overfitting, pruning is used. It reduces the size of the tree by removing nodes that is less powerful</p></li>
</ul>
<ol class="arabic simple">
<li><p>Pre-pruning: Stops the tree from growing once it meets criteria</p></li>
<li><p>Post-pruning : Remove branches from a fully grown tree that do not provide significant power.</p></li>
</ol>
<section id="reference-link-https-www-geeksforgeeks-org-decision-tree">
<h3>Reference Link : <a class="reference external" href="https://www.geeksforgeeks.org/decision-tree/">https://www.geeksforgeeks.org/decision-tree/</a><a class="headerlink" href="#reference-link-https-www-geeksforgeeks-org-decision-tree" title="Link to this heading">#</a></h3>
</section>
</section>
<section id="code-implimentation-from-scratch">
<h2>6. Code Implimentation from Scratch<a class="headerlink" href="#code-implimentation-from-scratch" title="Link to this heading">#</a></h2>
<section id="reference-link-https-anderfernandez-com-en-blog-code-decision-tree-python-from-scratch">
<h3>Reference link : <a class="reference external" href="https://anderfernandez.com/en/blog/code-decision-tree-python-from-scratch/">https://anderfernandez.com/en/blog/code-decision-tree-python-from-scratch/</a><a class="headerlink" href="#reference-link-https-anderfernandez-com-en-blog-code-decision-tree-python-from-scratch" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ucimlrepo</span> <span class="kn">import</span> <span class="n">fetch_ucirepo</span> 
  
<span class="c1"># fetch dataset </span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">fetch_ucirepo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">53</span><span class="p">)[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="s1">&#39;original&#39;</span><span class="p">]</span>
  
<span class="c1"># data (as pandas dataframes) </span>
<span class="n">X</span> <span class="o">=</span> <span class="n">iris</span><span class="p">[[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">iris</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">iris</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length</th>
      <th>sepal width</th>
      <th>petal length</th>
      <th>petal width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X2</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">sl</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="s1">&#39;sepal length&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">5.843333</span><span class="p">,</span>
    <span class="n">sw</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="s1">&#39;sepal width&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">3.054000</span><span class="p">,</span>
    <span class="n">pl</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="s1">&#39;petal length&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">3.758667</span><span class="p">,</span>
    <span class="n">pw</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="s1">&#39;petal width&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">1.198667</span>
<span class="p">)[[</span><span class="s1">&#39;sl&#39;</span><span class="p">,</span><span class="s1">&#39;sw&#39;</span><span class="p">,</span><span class="s1">&#39;pl&#39;</span><span class="p">,</span><span class="s1">&#39;pw&#39;</span><span class="p">]]</span>
<span class="n">iris2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X2</span><span class="p">,</span><span class="n">y</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris3</span> <span class="o">=</span> <span class="n">iris2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">iris2</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;Iris-setosa&#39;</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">def</span> <span class="nf">gini_impurity</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  Given a Pandas Series, it calculates the Gini Impurity. </span>
<span class="sd">  y: variable with which calculate Gini Impurity.</span>
<span class="sd">  &#39;&#39;&#39;</span>
  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">/</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">gini</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">gini</span><span class="p">)</span>

  <span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span><span class="p">(</span><span class="s1">&#39;Object must be a Pandas Series.&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
<span class="n">gini_impurity</span><span class="p">(</span><span class="n">iris3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">iris3</span><span class="p">[</span><span class="s1">&#39;sl&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;class&#39;</span><span class="p">]),</span>
<span class="n">gini_impurity</span><span class="p">(</span><span class="n">iris3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">iris3</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;class&#39;</span><span class="p">]),</span>
<span class="n">gini_impurity</span><span class="p">(</span><span class="n">iris3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">iris3</span><span class="p">[</span><span class="s1">&#39;pl&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;class&#39;</span><span class="p">]),</span>
<span class="n">gini_impurity</span><span class="p">(</span><span class="n">iris3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">iris3</span><span class="p">[</span><span class="s1">&#39;pw&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;class&#39;</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.46693877551020413 0.4351999999999999 0.49716730257833275 0.49382716049382713
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris3_subset</span> <span class="o">=</span> <span class="n">iris3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">iris3</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">,:]</span>

<span class="nb">print</span><span class="p">(</span>
<span class="n">gini_impurity</span><span class="p">(</span><span class="n">iris3_subset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">iris3_subset</span><span class="p">[</span><span class="s1">&#39;sl&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;class&#39;</span><span class="p">]),</span>
<span class="n">gini_impurity</span><span class="p">(</span><span class="n">iris3_subset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">iris3_subset</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;class&#39;</span><span class="p">]),</span>
<span class="n">gini_impurity</span><span class="p">(</span><span class="n">iris3_subset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">iris3_subset</span><span class="p">[</span><span class="s1">&#39;pl&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;class&#39;</span><span class="p">]),</span>
<span class="n">gini_impurity</span><span class="p">(</span><span class="n">iris3_subset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">iris3_subset</span><span class="p">[</span><span class="s1">&#39;pw&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;class&#39;</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.4351999999999999 0.4351999999999999 0.4351999999999999 0.4351999999999999
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris3_subset</span> <span class="o">=</span> <span class="n">iris3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">iris3</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">False</span><span class="p">,:]</span>

<span class="nb">print</span><span class="p">(</span>
<span class="n">gini_impurity</span><span class="p">(</span><span class="n">iris3_subset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">iris3_subset</span><span class="p">[</span><span class="s1">&#39;sl&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;class&#39;</span><span class="p">]),</span>
<span class="n">gini_impurity</span><span class="p">(</span><span class="n">iris3_subset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">iris3_subset</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;class&#39;</span><span class="p">]),</span>
<span class="n">gini_impurity</span><span class="p">(</span><span class="n">iris3_subset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">iris3_subset</span><span class="p">[</span><span class="s1">&#39;pl&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;class&#39;</span><span class="p">]),</span>
<span class="n">gini_impurity</span><span class="p">(</span><span class="n">iris3_subset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">iris3_subset</span><span class="p">[</span><span class="s1">&#39;pw&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;class&#39;</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris3_subset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sl</th>
      <th>sw</th>
      <th>pl</th>
      <th>pw</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>50</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>51</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>52</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>56</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>65</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>70</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>85</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>86</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-versicolor</td>
    </tr>
    <tr>
      <th>100</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>109</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>110</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>115</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>117</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>120</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>124</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>125</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>131</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>136</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>137</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>139</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>140</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>141</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>143</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>144</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-virginica</td>
    </tr>
    <tr>
      <th>148</th>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>Iris-virginica</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">entropy</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  Given a Pandas Series, it calculates the entropy. </span>
<span class="sd">  y: variable with which calculate entropy.</span>
<span class="sd">  &#39;&#39;&#39;</span>
  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">/</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">entropy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="mf">1e-9</span><span class="p">))</span>
    <span class="k">return</span><span class="p">(</span><span class="n">entropy</span><span class="p">)</span>

  <span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span><span class="p">(</span><span class="s1">&#39;Object must be a Pandas Series.&#39;</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span>
<span class="n">entropy</span><span class="p">(</span><span class="n">iris3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">iris3</span><span class="p">[</span><span class="s1">&#39;sl&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;class&#39;</span><span class="p">]),</span>
<span class="n">entropy</span><span class="p">(</span><span class="n">iris3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">iris3</span><span class="p">[</span><span class="s1">&#39;sw&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;class&#39;</span><span class="p">]),</span>
<span class="n">entropy</span><span class="p">(</span><span class="n">iris3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">iris3</span><span class="p">[</span><span class="s1">&#39;pl&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;class&#39;</span><span class="p">]),</span>
<span class="n">entropy</span><span class="p">(</span><span class="n">iris3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">iris3</span><span class="p">[</span><span class="s1">&#39;pw&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;class&#39;</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">variance</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  Function to help calculate the variance avoiding nan.</span>
<span class="sd">  y: variable to calculate variance to. It should be a Pandas Series.</span>
<span class="sd">  &#39;&#39;&#39;</span>
  <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">0</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">y</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">information_gain</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">entropy</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  It returns the Information Gain of a variable given a loss function.</span>
<span class="sd">  y: target variable.</span>
<span class="sd">  mask: split choice.</span>
<span class="sd">  func: function to be used to calculate Information Gain in case os classification.</span>
<span class="sd">  &#39;&#39;&#39;</span>
  
  <span class="n">a</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
  <span class="n">b</span> <span class="o">=</span> <span class="n">mask</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span>
  
  <span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">b</span> <span class="o">==</span><span class="mi">0</span><span class="p">):</span> 
    <span class="n">ig</span> <span class="o">=</span> <span class="mi">0</span>
  
  <span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">y</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">!=</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span>
      <span class="n">ig</span> <span class="o">=</span> <span class="n">variance</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">a</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">*</span> <span class="n">variance</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mask</span><span class="p">]))</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">variance</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="n">mask</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">ig</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="n">a</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">func</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span><span class="o">-</span><span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">*</span><span class="n">func</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="n">mask</span><span class="p">])</span>
  
  <span class="k">return</span> <span class="n">ig</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># information_gain(data[&#39;obese&#39;], data[&#39;Gender&#39;] == &#39;Male&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">itertools</span>

<span class="k">def</span> <span class="nf">categorical_options</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  Creates all possible combinations from a Pandas Series.</span>
<span class="sd">  a: Pandas Series from where to get all possible combinations. </span>
<span class="sd">  &#39;&#39;&#39;</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

  <span class="n">opciones</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">subset</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">L</span><span class="p">):</span>
          <span class="n">subset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span>
          <span class="n">opciones</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">subset</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">opciones</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">max_information_gain_split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">entropy</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  Given a predictor &amp; target variable, returns the best split, the error and the type of variable based on a selected cost function.</span>
<span class="sd">  x: predictor variable as Pandas Series.</span>
<span class="sd">  y: target variable as Pandas Series.</span>
<span class="sd">  func: function to be used to calculate the best split.</span>
<span class="sd">  &#39;&#39;&#39;</span>

  <span class="n">split_value</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">ig</span> <span class="o">=</span> <span class="p">[]</span> 

  <span class="n">numeric_variable</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">dtypes</span> <span class="o">!=</span> <span class="s1">&#39;O&#39;</span> <span class="k">else</span> <span class="kc">False</span>

  <span class="c1"># Create options according to variable type</span>
  <span class="k">if</span> <span class="n">numeric_variable</span><span class="p">:</span>
    <span class="n">options</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
  <span class="k">else</span><span class="p">:</span> 
    <span class="n">options</span> <span class="o">=</span> <span class="n">categorical_options</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

  <span class="c1"># Calculate ig for all values</span>
  <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
    <span class="n">mask</span> <span class="o">=</span>   <span class="n">x</span> <span class="o">&lt;</span> <span class="n">val</span> <span class="k">if</span> <span class="n">numeric_variable</span> <span class="k">else</span> <span class="n">x</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="n">val_ig</span> <span class="o">=</span> <span class="n">information_gain</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
    <span class="c1"># Append results</span>
    <span class="n">ig</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val_ig</span><span class="p">)</span>
    <span class="n">split_value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

  <span class="c1"># Check if there are more than 1 results if not, return False</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ig</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">return</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

  <span class="k">else</span><span class="p">:</span>
  <span class="c1"># Get results with highest IG</span>
    <span class="n">best_ig</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ig</span><span class="p">)</span>
    <span class="n">best_ig_index</span> <span class="o">=</span> <span class="n">ig</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">best_ig</span><span class="p">)</span>
    <span class="n">best_split</span> <span class="o">=</span> <span class="n">split_value</span><span class="p">[</span><span class="n">best_ig_index</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">best_ig</span><span class="p">,</span><span class="n">best_split</span><span class="p">,</span><span class="n">numeric_variable</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>


<span class="c1"># weight_ig, weight_slpit, _, _ = max_information_gain_split(data[&#39;Weight&#39;], data[&#39;obese&#39;],)  </span>


<span class="c1"># print(</span>
<span class="c1">#   &quot;The best split for Weight is when the variable is less than &quot;,</span>
<span class="c1">#   weight_slpit,&quot;\nInformation Gain for that split is:&quot;, weight_ig</span>
<span class="c1"># )</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight_ig</span><span class="p">,</span> <span class="n">weight_slpit</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">max_information_gain_split</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="s1">&#39;sepal length&#39;</span><span class="p">],</span> <span class="n">y</span><span class="p">)</span>  


<span class="nb">print</span><span class="p">(</span>
  <span class="s2">&quot;The best split for Weight is when the variable is less than &quot;</span><span class="p">,</span>
  <span class="n">weight_slpit</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Information Gain for that split is:&quot;</span><span class="p">,</span> <span class="n">weight_ig</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">max_information_gain_split</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "carparts"
        },
        kernelOptions: {
            name: "carparts",
            path: "./week2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'carparts'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../week1/Regularization.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">L1 and L2 Regularization</p>
      </div>
    </a>
    <a class="right-next"
       href="2.PCA.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">What is Principal Component Analysis?</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dt-structure">1. DT Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#procedure">2. Procedure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#metrics-for-splitting">3. Metrics for splitting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advantages-and-disadvantages">4. Advantages and Disadvantages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pruning">5. Pruning</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reference-link-https-www-geeksforgeeks-org-decision-tree">Reference Link : https://www.geeksforgeeks.org/decision-tree/</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code-implimentation-from-scratch">6. Code Implimentation from Scratch</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reference-link-https-anderfernandez-com-en-blog-code-decision-tree-python-from-scratch">Reference link : https://anderfernandez.com/en/blog/code-decision-tree-python-from-scratch/</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>